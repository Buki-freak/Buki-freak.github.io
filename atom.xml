<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>buk1</title>
  
  <subtitle>Every day is my last day.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://buki-freak.github.io/"/>
  <updated>2020-08-03T07:05:31.815Z</updated>
  <id>https://buki-freak.github.io/</id>
  
  <author>
    <name>buki</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>De1ta-CTF-2020-Review</title>
    <link href="https://buki-freak.github.io/2020/08/03/De1ta-CTF-2020-Review/"/>
    <id>https://buki-freak.github.io/2020/08/03/De1ta-CTF-2020-Review/</id>
    <published>2020-08-03T03:40:01.862Z</published>
    <updated>2020-08-03T07:05:31.815Z</updated>
    
    <content type="html"><![CDATA[<p>Only review in Crypto.</p><h1 id="nlfsrunsolved"><a class="markdownIt-Anchor" href="#nlfsrunsolved"></a> nlfsr(unsolved)</h1><p>This challenge consists of 4 linear feedback shift registers (below I use LFSR instead), with accordingly 19 bits, 19 bits, 6 bits and 3 bits state length. Here is the given file:</p><p><strong><a href="http://quiz.py" target="_blank" rel="noopener">quiz.py</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> a, b, c, d, flag</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">"De1CTF&#123;"</span> + <span class="string">''</span>.join([hex(i)[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> [a, b, c, d]]) + <span class="string">"&#125;"</span></span><br><span class="line"><span class="keyword">assert</span> [len(bin(i)[<span class="number">2</span>:]) <span class="keyword">for</span> i <span class="keyword">in</span> [a, b, c, d]] == [<span class="number">19</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">ma, mb, mc, md = <span class="number">0x505a1</span>, <span class="number">0x40f3f</span>, <span class="number">0x1f02</span>, <span class="number">0x31</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lfsr</span><span class="params">(r, m)</span>:</span> <span class="keyword">return</span> ((r &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span>) ^ (bin(r &amp; m).count(<span class="string">'1'</span>) % <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">combine</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> a, b, c, d</span><br><span class="line">    a = lfsr(a, ma)</span><br><span class="line">    b = lfsr(b, mb)</span><br><span class="line">    c = lfsr(c, mc)</span><br><span class="line">    d = lfsr(d, md)</span><br><span class="line">    [ao, bo, co, do] = [i &amp; <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> [a, b, c, d]]</span><br><span class="line">    <span class="keyword">return</span> (ao*bo) ^ (bo*co) ^ (bo*do) ^ co ^ do</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genkey</span><span class="params">(nb)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(nb*<span class="number">8</span>):</span><br><span class="line">        s += str(combine())</span><br><span class="line">    open(<span class="string">"data"</span>, <span class="string">"w+"</span>).write(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">genkey(<span class="number">128</span>*<span class="number">1024</span>)</span><br></pre></td></tr></table></figure><p><strong>data</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">a</span> <span class="keyword">string</span> that comprises <span class="keyword">of</span> <span class="number">128</span>*<span class="number">1024</span>*<span class="number">8</span> bits(only <span class="literal">zero</span> <span class="keyword">or</span> <span class="literal">one</span>)</span><br></pre></td></tr></table></figure><h2 id="explanation"><a class="markdownIt-Anchor" href="#explanation"></a> Explanation</h2><p>There are four LFSR in <a href="http://quiz.py" target="_blank" rel="noopener">quiz.py</a> and each round, four LFSR simultaneously compute four according output. Then the combination function combines these four bits and output the combination result into file data.</p><h2 id="condition"><a class="markdownIt-Anchor" href="#condition"></a> Condition</h2><p>Since LFSR is the basic knowledge for us, there will more no more explanation on it. So let‚Äôs see what we have  got from the files.</p><blockquote><p>the initial state length of each LFSR</p><p>the taps of each LFSR</p><p>a combination function</p><p>many rounds combination results</p></blockquote><p>It seems to be a simple quiz because we have already known the taps of each LFSR. However, each output of four LFSR is combined as one bit, from which we can hardly retrieve the outputs of four LFSR. If we use pure brute-force attack method, the complexity would be:</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>47</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^{47})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>Such a large scale. We must relate one or some output of four LFSR to the combination result and solve the each state independently. We can use a strategies called <strong>correlation attack</strong> in stream cipher.</p><h2 id="details"><a class="markdownIt-Anchor" href="#details"></a> Details</h2><p>We first look into each possible situation of four LFSR and write down the result.</p><table><thead><tr><th>ao</th><th>bo</th><th>co</th><th>do</th><th>combine</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr><tr><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td></tr><tr><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td></tr><tr><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td></tr><tr><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td></tr><tr><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td></tr><tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td></tr><tr><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td></tr><tr><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td></tr><tr><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td></tr><tr><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr></tbody></table><p>In the table, ao represents the single output of LFSR-1 and so on. It is very obvious that ao has 75% correlation with the combination output, and we also know that if we have the correct initial state of LFSR-1,  three out of four output of LFSR-1 will be the same as the combination bits. As a result, we can independently search the initial state of LFSR-1, and the correct initial state should be the fittest one. Now the complexity comes down to:</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>19</mn></msup><mo>+</mo><msup><mn>2</mn><mn>28</mn></msup><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>28</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^{19}+2^{28})=O({2^{28}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>This is already considerable in brute-force attack method (I use approximately 3 hours with C++, half a day with python to solve). But sadly, outputs of other LFSR just has 50% correlation with the combination output (actually no correlation). We can look into the combination function:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ao*<span class="keyword">bo</span>) ^ (<span class="keyword">bo</span>*<span class="keyword">co</span>) ^ (<span class="keyword">bo</span>*<span class="keyword">do</span>) ^ <span class="keyword">co</span> ^ <span class="keyword">do</span></span><br></pre></td></tr></table></figure><p>And interestingly it can be transformed into:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(ao*<span class="keyword">bo</span>) ^ ((<span class="keyword">bo</span>^<span class="number">1</span>) * (<span class="keyword">co</span>^<span class="keyword">do</span>))</span><br></pre></td></tr></table></figure><p>Calculating the XOR result of co and do by ourselves, we can surprisingly find that there is correlation between (co^do) and the combination result. Try to write down the table again.</p><table><thead><tr><th>ao</th><th>bo</th><th>co^do</th><th>combine</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>0</td><td>0</td><td>1</td><td>1</td></tr><tr><td>0</td><td>1</td><td>0</td><td>0</td></tr><tr><td>0</td><td>1</td><td>1</td><td>0</td></tr><tr><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>1</td><td>1</td><td>1</td><td>1</td></tr></tbody></table><p>Again we can know from the table that (co^do) has 75% correlation with the combination output, which is the same as ao. There the complexity comes down again to:</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>19</mn></msup><mo>+</mo><msup><mn>2</mn><mn>9</mn></msup><mo>+</mo><msup><mn>2</mn><mn>19</mn></msup><mo stretchy="false">)</mo><mo>=</mo><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mn>20</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(2^{19}+2^{9}+2^{19})=O(2^{20})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>The complexity is very considerable now.</p><h2 id="realization"><a class="markdownIt-Anchor" href="#realization"></a> Realization</h2><p>Official realization</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ma, mb, mc, md = <span class="number">0x505a1</span>, <span class="number">0x40f3f</span>, <span class="number">0x1f02</span>, <span class="number">0x31</span></span><br><span class="line">key = open(<span class="string">"data"</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lfsr</span><span class="params">(r, m)</span>:</span> <span class="keyword">return</span> ((r &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xffffff</span>) ^ (bin(r &amp; m).count(<span class="string">'1'</span>) % <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcR</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(x) == len(y)</span><br><span class="line">    cnt = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> i, j <span class="keyword">in</span> zip(x, y):</span><br><span class="line">        cnt += (i == j)</span><br><span class="line">    <span class="keyword">return</span> cnt / len(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brutea</span><span class="params">(nb)</span>:</span></span><br><span class="line">    relation, reala = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">2</span> ** <span class="number">19</span>):</span><br><span class="line">        s = <span class="string">''</span></span><br><span class="line">        a = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(nb * <span class="number">8</span>):</span><br><span class="line">            a = lfsr(a, ma)</span><br><span class="line">            s += str(a &amp; <span class="number">1</span>)</span><br><span class="line">        r = calcR(s, key[:nb * <span class="number">8</span>])</span><br><span class="line">        <span class="keyword">if</span> relation &lt; r:</span><br><span class="line">            relation, reala = r, i</span><br><span class="line">    print(reala, relation)</span><br><span class="line">    <span class="keyword">return</span> reala</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brutecd</span><span class="params">(nb)</span>:</span></span><br><span class="line">    relation, realc, reald = <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">2</span> ** <span class="number">6</span>):</span><br><span class="line">        d = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">2</span> ** <span class="number">13</span>):</span><br><span class="line">            c = j</span><br><span class="line">            s = <span class="string">''</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(nb * <span class="number">8</span>):</span><br><span class="line">                c = lfsr(c, mc)</span><br><span class="line">                d = lfsr(d, md)</span><br><span class="line">                s += str((c &amp; <span class="number">1</span>) ^ (d &amp; <span class="number">1</span>))</span><br><span class="line">            r = calcR(s, key[:nb * <span class="number">8</span>])</span><br><span class="line">            <span class="keyword">if</span> relation &lt; r:</span><br><span class="line">                relation, realc, reald = r, j, i</span><br><span class="line">    print(realc, reald, relation)</span><br><span class="line">    <span class="keyword">return</span> realc, reald</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bruteb</span><span class="params">(nb, a_, c_, d_)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">2</span> ** <span class="number">19</span>):</span><br><span class="line">        b = i</span><br><span class="line">        a, c, d = a_, c_, d_</span><br><span class="line">        s = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(nb * <span class="number">8</span>):</span><br><span class="line">            a = lfsr(a, ma)</span><br><span class="line">            b = lfsr(b, mb)</span><br><span class="line">            c = lfsr(c, mc)</span><br><span class="line">            d = lfsr(d, md)</span><br><span class="line">            [ao, bo, co, do] = [k &amp; <span class="number">1</span> <span class="keyword">for</span> k <span class="keyword">in</span> [a, b, c, d]]</span><br><span class="line">            s += str((ao * bo) ^ (bo * co) ^ (bo * do) ^ co ^ do)</span><br><span class="line">        <span class="keyword">if</span> s == key[:nb * <span class="number">8</span>]:</span><br><span class="line">            print(i)</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    start_time = time.time()</span><br><span class="line">    print(start_time)</span><br><span class="line">    a = brutea(<span class="number">20</span>)</span><br><span class="line">    c, d = brutecd(<span class="number">20</span>)</span><br><span class="line">    b = bruteb(<span class="number">20</span>, a, c, d)</span><br><span class="line">    <span class="string">"De1CTF&#123;%s&#125;"</span> % (<span class="string">''</span>.join([hex(i)[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> [a, b, c, d]]))</span><br><span class="line">    end_time = time.time()</span><br><span class="line">    print(<span class="string">"Used time:"</span>, end_time - start_time)</span><br><span class="line"><span class="comment"># De1CTF&#123;58bb578d5611363f&#125;</span></span><br></pre></td></tr></table></figure><p>Other challenges still remain confused.</p><h1 id="what-i-have-done"><a class="markdownIt-Anchor" href="#what-i-have-done"></a> What I have done</h1><p>I spent half of my afternoon writing this article, and I still have a long way to go. Keep on learning IELTS and number theory.</p><h1 id="things-to-learn-and-improve"><a class="markdownIt-Anchor" href="#things-to-learn-and-improve"></a> Things to Learn and Improve</h1><ul><li>How to use sage</li><li>Do a review on wangdibei</li></ul><h1 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h1><ul><li><a href="https://en.wikipedia.org/wiki/Correlation_attack" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Correlation_attack</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Only review in Crypto.&lt;/p&gt;
&lt;h1 id=&quot;nlfsrunsolved&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#nlfsrunsolved&quot;&gt;&lt;/a&gt; nlfsr(unsolved)&lt;/h1&gt;
&lt;p&gt;This ch
      
    
    </summary>
    
    
    
      <category term="Review" scheme="https://buki-freak.github.io/tags/Review/"/>
    
  </entry>
  
  <entry>
    <title>Â§©ÁøºÊùØ-2020-Writeup</title>
    <link href="https://buki-freak.github.io/2020/07/31/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2020-Writeup/"/>
    <id>https://buki-freak.github.io/2020/07/31/%E5%A4%A9%E7%BF%BC%E6%9D%AF-2020-Writeup/</id>
    <published>2020-07-31T15:00:19.000Z</published>
    <updated>2020-08-03T03:24:09.259Z</updated>
    
    <content type="html"><![CDATA[<p>ÊØîËµõÊéíÂæóÂæàÂØÜÔºågkd Êää writeup ÂÜô‰∫Ü„ÄÇ</p><h1 id="easyrsa"><a class="markdownIt-Anchor" href="#easyrsa"></a> easyRSA</h1><p>Á≠æÂà∞È¢òÔºåÂØπ‰∫éÊØè‰∏ÄÊ¨°Âä†ÂØÜÔºåÊòéÊñáÁ©∫Èó¥Â∞èÔºå‰∫éÊòØÁõ¥Êé•ÈÅçÂéÜ„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">n = ...</span><br><span class="line">cipher = ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">e = <span class="number">11299</span></span><br><span class="line">plaintext = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(cipher)):</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> string.printable:</span><br><span class="line">        <span class="keyword">if</span> pow(ord(s),e,n) == cipher[i]:</span><br><span class="line">            plaintext += s</span><br><span class="line">            print(plaintext)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h1 id="hardrsa"><a class="markdownIt-Anchor" href="#hardrsa"></a> hardRSA</h1><p>Â∑≤Áü• d ‰Ωé 539 ‰ΩçÔºåq ‰∏∫ 510 ‰ΩçÔºåËÆ°ÁÆó‰Ωé‰Ωç q ÁöÑÊñπÊ≥ïÂèØ‰ª•Áõ¥Êé•Ëé∑Âæó q„ÄÇ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_q</span><span class="params">(d0, kbits, e, n, p)</span>:</span></span><br><span class="line">    X = var(<span class="string">'X'</span>)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        results = solve_mod([e*d0*X - k*(p<span class="number">-1</span>)*X*(n//p-X+<span class="number">1</span>) + (p<span class="number">-1</span>)*k*(n//p) == X], <span class="number">2</span>^kbits)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> results:</span><br><span class="line">            q0 = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            <span class="keyword">if</span> n % q0 == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> q0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    n = <span class="number">12723332779402711330767180202990021139894727917028981722242076998825097254419567024122271773380821224949951558669351311750240296591612098048129709925844660421849429715755474874708286508736369884566273719494870891070006251521469139401722700298201541140391493575314714966432624976434199682124684035067305114749262672684081617896579640435891181745346695293618235303178334371123418790204709073465264408888007492994820133128499094347122686903153588634296508454120927</span></span><br><span class="line">    e = <span class="number">7</span></span><br><span class="line">    p = <span class="number">3141886348112988339174865432179206412942588390228169645162293920470188882447855208783220899752887620221059861467348059334030873350571979462363834615231089</span></span><br><span class="line">    c = <span class="number">8696771272015513736887843395612361647314297287781507609196936354183211655364744684164300710583625473872942712063309507651496314800393009480421886926137403759228421858414833429980059903049311837014449093365911603108158352871851677457256058510822509157407703210866317472894586087554001158540951787167699161720491198674848526093644131709561995379565643716017359731201935855247285498574923656191121426618306186331615280461405913653781283860760013215603007314688132</span></span><br><span class="line">    d0 = <span class="number">0x414946b9c40728f9801e61e98ec6d17525cbe4163a5ffb8367b65c652ae4cc3abce62e70afbfb84fcf937b3119953b48922be19ef4312c4f3a88313368ca6c9b1d658b7</span></span><br><span class="line">    </span><br><span class="line">    nbits = n.nbits()</span><br><span class="line">    kbits = d0.nbits()</span><br><span class="line"></span><br><span class="line">    q = find_q(d0, kbits, e, n, p)</span><br><span class="line">    r = n // q // p</span><br><span class="line">    phi = (r - <span class="number">1</span>) * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = gmpy2.invert(e,phi)</span><br><span class="line">    print(long_to_bytes(pow(c,d,n)))</span><br></pre></td></tr></table></figure><p><strong>psÔºö‰πãÂêéÊääÊé®ÂØºËøáÁ®ãË°•‰∏ä</strong></p><h1 id="alicehomework"><a class="markdownIt-Anchor" href="#alicehomework"></a> AliceHomework</h1><p>LLL Ê≤°Ë∑ëÂá∫Êù•ÔºåÁñëÊÉë.jpg</p><h1 id="polycrypto"><a class="markdownIt-Anchor" href="#polycrypto"></a> PolyCrypto</h1><p>Ê≤°Êó∂Èó¥ÁúãÈ¢ò„ÄÇ„ÄÇ„ÄÇtcl</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ÊØîËµõÊéíÂæóÂæàÂØÜÔºågkd Êää writeup ÂÜô‰∫Ü„ÄÇ&lt;/p&gt;
&lt;h1 id=&quot;easyrsa&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#easyrsa&quot;&gt;&lt;/a&gt; easyRSA&lt;/h1&gt;
&lt;p&gt;Á≠æÂà∞È¢òÔºåÂØπ‰∫éÊØè‰∏ÄÊ¨°Âä†ÂØÜÔºåÊòéÊñáÁ©∫Èó¥Â∞èÔºå‰∫éÊòØÁõ¥Êé•ÈÅçÂéÜ„ÄÇ
      
    
    </summary>
    
    
    
      <category term="Writeup" scheme="https://buki-freak.github.io/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>3kctf-2020-Review</title>
    <link href="https://buki-freak.github.io/2020/07/27/3kctf-2020-Review/"/>
    <id>https://buki-freak.github.io/2020/07/27/3kctf-2020-Review/</id>
    <published>2020-07-27T06:21:11.000Z</published>
    <updated>2020-08-03T03:26:54.575Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pyzzle1"><a class="markdownIt-Anchor" href="#pyzzle1"></a> pyzzle1</h1><p>Given a cst tree code, use libcst package in python to transform it into source code:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libcst <span class="keyword">import</span> *</span><br><span class="line">abc = Module(....</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'...'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(str(abc.code))</span><br></pre></td></tr></table></figure><p>Here is the source code in python:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">plaintext = <span class="string">"REDACTED"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exor</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    temp = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">if</span> (a[i] == b[i]):</span><br><span class="line">            temp += <span class="string">"0"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            temp += <span class="string">"1"</span></span><br><span class="line">    <span class="keyword">return</span> temp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BinaryToDecimal</span><span class="params">(binary)</span>:</span></span><br><span class="line">    string = int(binary, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># encryption</span></span><br><span class="line">PT_Ascii = [ord(x) <span class="keyword">for</span> x <span class="keyword">in</span> plaintext]</span><br><span class="line"></span><br><span class="line">PT_Bin = [format(y, <span class="string">'08b'</span>) <span class="keyword">for</span> y <span class="keyword">in</span> PT_Ascii]</span><br><span class="line">PT_Bin = <span class="string">""</span>.join(PT_Bin)</span><br><span class="line"></span><br><span class="line">n = <span class="number">26936</span></span><br><span class="line">K1 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line">K2 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line"></span><br><span class="line">L1 = PT_Bin[<span class="number">0</span>:n]</span><br><span class="line">R1 = PT_Bin[n::]</span><br><span class="line"></span><br><span class="line">f1 = exor(R1, K1)</span><br><span class="line">R2 = exor(f1, L1)</span><br><span class="line">L2 = R1</span><br><span class="line"></span><br><span class="line">f2 = exor(R2, K2)</span><br><span class="line">R3 = exor(f2, L2)</span><br><span class="line">L3 = R2</span><br><span class="line"></span><br><span class="line">R3 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line">L3 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line">cipher = L3+R3</span><br><span class="line"></span><br><span class="line"><span class="comment"># # decryption (redacted)</span></span><br><span class="line"><span class="comment"># plaintext = L6+R6</span></span><br><span class="line"><span class="comment"># plaintext = int(plaintext, 2)</span></span><br><span class="line"><span class="comment"># plaintext = binascii.unhexlify('%x' % plaintext)</span></span><br><span class="line"><span class="comment"># print(plaintext)</span></span><br></pre></td></tr></table></figure><p>This is a pretty easy structure, we can easily recover plaintext by:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exor</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    temp = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">if</span> (a[i] == b[i]):</span><br><span class="line">            temp += <span class="string">"0"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            temp += <span class="string">"1"</span></span><br><span class="line">    <span class="keyword">return</span> temp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">26936</span></span><br><span class="line">K1 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line">K2 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line">R3 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line">L3 = <span class="string">''''''</span> <span class="comment"># Too long to show</span></span><br><span class="line"></span><br><span class="line">R2 = L3</span><br><span class="line">L2 = exor(exor(K2, R2), R3)</span><br><span class="line"></span><br><span class="line">R1 = L2</span><br><span class="line">L1 = exor(exor(K1, R1), R2)</span><br><span class="line"></span><br><span class="line">plaintext = L1+R1</span><br><span class="line">plaintext = int(plaintext, <span class="number">2</span>)</span><br><span class="line">plaintext = binascii.unhexlify(<span class="string">'%x'</span> % plaintext)</span><br><span class="line">plaintext = binascii.unhexlify(plaintext)</span><br><span class="line">print(plaintext)</span><br></pre></td></tr></table></figure><p>The flag is : 3k{almost_done_shizzle_up_my_nizzle}</p><h1 id="once_upon_a_time"><a class="markdownIt-Anchor" href="#once_upon_a_time"></a> Once_upon_a_time</h1><p>Given a program and encrypted flag:</p><blockquote><p>scss : program entrance</p><p>main.c</p><p>cipher.c</p><p>flag_encrypted</p><p>‚Ä¶</p></blockquote><p>Excellent realization of LFSR and block cipher encryption in C.</p><p>We notice that the initial vector is fixed, 0xa2 üòÉ Addtionally, the key is fixed too, which means we can always get the same key stream. Moreover, I find something wired in cipher.c:</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">ECB:</span></span><br><span class="line">    temp_ciphertext = temp_keystream ^ temp_plaintext;</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>We can create a file with only ‚Äò\x00‚Äô and encrypt it in ECB mode to get the keystream.</p><p>Since there are five modes, we can only try every situations.</p><p>Woooool, finally catch ya! OFB!</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">20</span>]: plaintext = <span class="string">''</span>                                                         </span><br><span class="line"></span><br><span class="line">In [<span class="number">21</span>]: <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">113</span>): </span><br><span class="line">    ...:     iv = iv ^ keystream[i] </span><br><span class="line">    ...:     temp = iv ^ cipher[i] </span><br><span class="line">    ...:     plaintext += chr(temp) </span><br><span class="line">    ...:                                                                        </span><br><span class="line"></span><br><span class="line">In [<span class="number">22</span>]: plaintext                                                              </span><br><span class="line">Out[<span class="number">22</span>]: <span class="string">'3k&#123;my_hands_are_registered_as_lethal_weapons_that_means_we_get_into_a_fight_i_accidentally_kill_you_i_go_to_jail&#125;'</span></span><br></pre></td></tr></table></figure><p>The flag is : 3k{my_hands_are_registered_as_lethal_weapons_that_means_we_get_into_a_fight_i_accidentally_kill_you_i_go_to_jail}</p><h1 id="you-shall-not-get-my-cookies"><a class="markdownIt-Anchor" href="#you-shall-not-get-my-cookies"></a> You shall not get my cookies</h1><p>Given an example cipher, and if the cipher can be correctly decrypted, it will send ‚ÄúNop‚Äù back.</p><p>I follow the write up here: <a href="https://ctftime.org/writeup/22602" target="_blank" rel="noopener">https://ctftime.org/writeup/22602</a></p><p>Notice that there is an error in the write up above: if the length of a block is 16 bytes, it will be appended a block of sixteen ‚Äò\x16‚Äô according to PKCS#7 padding principle.</p><p>Here is my exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line">target = <span class="string">'youshallnotgetmycookies.3k.ctf.to'</span></span><br><span class="line">port = <span class="number">13337</span></span><br><span class="line"></span><br><span class="line">cipher = <span class="string">"6F6A6A2C6E780D070A19001707060C0D"</span></span><br><span class="line"></span><br><span class="line">suffix = <span class="string">''</span></span><br><span class="line">fake_iv = <span class="string">''</span></span><br><span class="line">dc = <span class="string">''</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">17</span>):</span><br><span class="line">        <span class="keyword">assert</span>(len(dc) == <span class="number">2</span>*(i<span class="number">-1</span>))</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0x100</span>):</span><br><span class="line">            guess = hex(j)[<span class="number">2</span>:].upper().zfill(<span class="number">2</span>)</span><br><span class="line">            fake_iv = <span class="string">'00'</span> * (<span class="number">16</span>-i) + guess + suffix</span><br><span class="line">            print(<span class="string">'[-]'</span> + fake_iv)</span><br><span class="line">            p = remote(target, port)</span><br><span class="line">            p.sendlineafter(<span class="string">'So... whats your cookie: '</span>, fake_iv + cipher)</span><br><span class="line">            res = p.recvall(timeout=<span class="number">4</span>)</span><br><span class="line">            p.close()</span><br><span class="line">            res = res.decode()</span><br><span class="line">            <span class="keyword">if</span>  len(res) == <span class="number">11</span>:</span><br><span class="line">                pad = bytes([i])</span><br><span class="line">                dc = hex(int(guess, <span class="number">16</span>) ^ bytes_to_long(pad))[<span class="number">2</span>:].upper().zfill(<span class="number">2</span>) + dc</span><br><span class="line">                suffix = hex(int(dc, <span class="number">16</span>) ^ bytes_to_long(bytes([(i+<span class="number">1</span>)]) * i))[<span class="number">2</span>:].upper().zfill(i*<span class="number">2</span>)</span><br><span class="line">                print(<span class="string">'[-]  D(C1) '</span>+ dc)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    print(<span class="string">'[-]  D(C1) '</span>+ dc)</span><br><span class="line"><span class="keyword">except</span> pwnlib.exception.PwnlibException:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1C091F451A0B070D00130A1D0D0C0607  for the first block to be d(C2)</span></span><br><span class="line"><span class="comment"># B0A608DDC37A458EEC0B74D37E888E8A  for the second block</span></span><br><span class="line"><span class="comment"># ...3B143145885BB42C94 for the third block</span></span><br><span class="line"><span class="comment"># C2</span></span><br><span class="line"><span class="comment"># 90C560B2A01529EF986E54B016E1FEAA</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># C1</span></span><br><span class="line"><span class="comment"># 6F6A6A2C6E780D070A19001707060C0D</span></span><br><span class="line"><span class="comment"># Calculate d(C1)</span></span><br><span class="line"><span class="comment"># 218A7AEECEFB49CADF3D227AD84A21CF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate C0</span></span><br><span class="line"><span class="comment"># 6CEB0A82ABDB06ABAB50471BB46A63A6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The whole fake cipher:</span></span><br><span class="line"><span class="comment"># 6CEB0A82ABDB06ABAB50471BB46A63A66F6A6A2C6E780D070A19001707060C0D90C560B2A01529EF986E54B016E1FEAA</span></span><br></pre></td></tr></table></figure><p>It cost 2 hours running this script twice.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;pyzzle1&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#pyzzle1&quot;&gt;&lt;/a&gt; pyzzle1&lt;/h1&gt;
&lt;p&gt;Given a cst tree code, use libcst package in python to tr
      
    
    </summary>
    
    
    
      <category term="Review" scheme="https://buki-freak.github.io/tags/Review/"/>
    
  </entry>
  
  <entry>
    <title>2020-First-Half-Review</title>
    <link href="https://buki-freak.github.io/2020/06/30/2020-First-Half-Review/"/>
    <id>https://buki-freak.github.io/2020/06/30/2020-First-Half-Review/</id>
    <published>2020-06-30T15:23:46.000Z</published>
    <updated>2020-07-17T02:47:27.086Z</updated>
    
    <content type="html"><![CDATA[<p>2020 Â∑≤ÁªèËøáÂçäÔºåÊñ∞Âπ¥ÁöÑÈíüÂ£∞‰ªø‰Ωõ‰ªçÁÑ∂Ëê¶ÁªïÂú®ËÄ≥Ëæπ„ÄÇÊó∂Èó¥ËøáÂæóÂ§™Âø´ÔºåÁïô‰∏ãÁöÑÂ§™Â∞ë„ÄÇ</p><h1 id="ÂõûÈ°æ"><a class="markdownIt-Anchor" href="#ÂõûÈ°æ"></a> ÂõûÈ°æ</h1><p>‰ªäÂπ¥ÁúüÁöÑÂæàÁâπÂà´ÂïäÔºå‰∫åÊúà‰ªΩÁöÑÊó∂ÂÄôËøòÊä±ÁùÄÂõûÂ≠¶Ê†°‰∏äËØæÁöÑÊÉ≥Ê≥ïÔºåÁé∞Âú®Â∑≤Áªè‰∏ä‰∫Ü‰∏ÄÂ≠¶ÊúüÁöÑÁΩëËØæ„ÄÇÂØπ‰∫éÁΩëËØæÂíåÂõûÂ≠¶Ê†°‰∏äËØæÔºåÊàëÊòØÂÅèÂêéËÄÖÁöÑ„ÄÇË¶ÅÁü•ÈÅìÔºåÂæÖÂú®ÂÆ∂ÈáåÂ≠¶‰π†ÊïàÁéá‰∏çÂà∞Â≠¶Ê†°ÁöÑÂçÅÂàÜ‰πã‰∏ÄÔºöÔºâ‰∏çËøáËøòÂ•ΩÔºåÁé∞Âú®Â•ΩÂÉèÊÖ¢ÊÖ¢‰π†ÊÉØ‰∏ãÂéª‰∫Ü hhhhh</p><p>Êú¨Êù•ÊòØ‰∫åÊúàÂ∫ïÂºÄÂ≠¶ÁöÑÔºå‰∏çËøáÂ≠¶Ê†°ËØ¥Êé®ËøüÂºÄÂ≠¶Ôºà‰∏çÂ∏¶ÁΩëËØæÁöÑÈÇ£ÁßçÔºâ„ÄÇÂ•ΩÂêßÔºåÁ≠âÂà∞‰∏âÊúà‰ªΩÔºåÁõº‰∫ÜËÆ∏‰πÖË∞ÅÁü•ÊîπÊàêÁΩëËØæÔºàÁõ¥Êé•Ë£ÇÂºÄ&gt;_&lt;ÔºåÁΩëËØæ==Ëá™Â≠¶„ÄÇ‰∏çÂæó‰∏çËØ¥ÔºåËøôÂçäÂπ¥Â§Ñ‰∫éÁúü¬∑ÁôΩÂ≠¶Èò∂ÊÆµÔºåÁôΩÂ≠¶ËÉΩÂäõÊèêÈ´ò‰∫Ü‰∏çÂ∞ë„ÄÇ</p><p>‰∏ÄÊúà‰∏ªË¶ÅÂú®Â≠¶‰∫Ü Matlab ÁºñÁ®ãÂíå LatexÔºå‰ªéÂü∫Êú¨ËØ≠Ê≥ïÂà∞ÁîªÂõæÔºåÂÜçÂà∞Â¶Ç‰ΩïÁî® Latex ÂÜôÂá∫‰∏ÄÁØá nice ÁöÑËÆ∫Êñá„ÄÇÂ≠¶Ëøô‰∏™‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÂáÜÂ§áÊï∞Ê®°Ôºå‰∏çËøáÂê¨ËØ¥ÊØï‰∏öËÆ∫ÊñáË¶ÅÁî® Latex 2333„ÄÇÂõ†‰∏∫ÂØíÂÅáÂâçÊúâ‰∏™ÊúãÂèãÊãâÊï∞Ê®°ÁæéËµõÔºåËá™Â∑±ÊÑüËßâÊÉ≥ËØïËØïÔºàËØ¥‰∏çÂÆöÂ•ΩÂ•ΩÂ≠¶ËÉΩÊãø‰∏™Â•ñ„ÄÇ‰∫éÊòØÂ∞±Êä•ÂêçÂéª‰∫ÜÔºåÊä•ÂêçË¥π‰πü‰∏ç‰æøÂÆú„ÄÇÂêéÈù¢ÂéªÂê¨‰∫ÜÂê¨ÈÇ£ËæπÁöÑÂü∫Á°ÄËØæÔºåÂª∫Ê®°ÂØπÊï∞Â≠¶Ë¶ÅÊ±ÇËøòÊòØÊå∫È´òÁöÑÔºåÊúâÁÇπÊáµ„ÄÇÂêéÈù¢ÊúãÂèãËØ¥ËÆ©ÊàëÂ≠¶Â≠¶ Matlab ÁºñÁ®ã„ÄÇÂü∫Á°ÄÂ≠¶‰∏ãÊù•ÂÖ∂ÂÆû‰πü‰∏çÁî®Ëä±ÂæàÈïøÊó∂Èó¥Ôºå‰ΩÜÊòØÊãñÁùÄÊãñÁùÄÂà∞‰∫åÊúà‰ªΩÂéª‰∫Ü„ÄÇ‰∏çËøáÂõûÊÉ≥ÈÇ£‰∏™Êó∂ÂÄôÔºåËá™Â∑±Ë∑üÁùÄÁΩë‰∏äÊïôÁ®ãËµ∞ÔºåËøòÊòØ‰∏çÈîôÁöÑ„ÄÇ</p><p>ÁæéËµõÂú®‰∏âÊúà‰ªΩÔºåÂü∫Á°ÄÊêûÂ•Ω‰∫Ü‰ª•ÂêéÂ∞±ÂºÄÂßãÊîæÈ£ûËá™Êàë‰∫ÜÔºàÁúüÂ∞±Âè™Êêû‰∫ÜÂü∫Á°Ä wdt„ÄÇÂÖ∂ÂÆû‰∏ªË¶ÅÊòØÂèëÁé∞Ëá™Â∑±Â§™‰πÖÊ≤°ÊêûÂ≠¶Áßë‰∫ÜÔºå‰∫éÊòØÂèàË∑ëÊù•ËøôËæπÂ≠¶Â≠¶„ÄÇÊéèÂá∫‰∏Ä‰∏™„ÄäÂø´‰πêÁöÑ Linux ÂëΩ‰ª§Ë°å„ÄãÔºå‰πüÂøò‰∫ÜÊòØË∞ÅÂèëÁªôÊàëÁöÑ‰∫ÜÔºåÁ≥ªÁªüÂú∞Ëøá‰∏ÄÈÅç Linux„ÄÇ‰ªéÊñá‰ª∂Á≥ªÁªüË∑≥ËΩ¨Âà∞ vim Â§ÑÁêÜÊñáÊú¨ ÂÜçÂà∞ËΩØ‰ª∂ÂåÖÁÆ°ÁêÜÔºåÊúÄÂêé shell ÁºñÁ®ãÔºåÈÄî‰∏≠È°∫‰æøÊç°Âõû‰∫ÜÊ≠£ÂàôË°®ËææÂºè„ÄÇÁúãÁöÑÊó∂ÂÄôÂÖ∂ÂÆûÁúüÁöÑÊúâÂæàÂ§ßÊÑüËß¶„ÄÇÁúãÊáÇÂëΩ‰ª§ÔºåÊèêÈ´ò‰∏ªÂä®ÊÄßÔºåËøôÊòØÊàëÊÇüÂá∫ÁöÑ‰∏ÄÁÇπ„ÄÇÊúÄËøëÈÄâËØæÁ™ÅÁÑ∂ÂèëÁé∞‰∏ãÂ≠¶ÊúüÊúâ‰∏ÄÈó®Âè´„ÄäÊìç‰ΩúÁ≥ªÁªüÂÆûË∑µ„ÄãÁöÑËØæÔºåËÆ≤ÂæóÂ∞±ÊòØ Linux ÂëΩ‰ª§2333</p><p>ÁæéËµõÈÇ£‰∏âÂ§©ÊØèÂ§©Âè™Áù°‰∫Ü6‰∏™Â∞èÊó∂ÔºåË¥üË¥£ÁºñÁ®ã„ÄÇÂè¶Â§ñ‰∏§‰∏™Â§ß‰Ω¨Âª∫Ê®°ÂàÜÊûêÁ≠âÁ≠âÔºàËøôÈáåÁöÑÁ≠âÁ≠âÁúÅÁï•‰∫ÜËÆ∏Â§ö‚Ä¶ wtcl ‰ª£Á†ÅÈÉΩÊòØÈòüÂèãÂ∏ÆÊàëÊâæÁöÑ„ÄÇÂΩìÊó∂ÂÖ∂ÂÆûÊå∫Ëá™Ë¥£ÁöÑÔºåÂà∞Âêé‰∏§Â§©ÊàëÊâçÂºÄÂßãÂèëÊå•‰ΩúÁî®„ÄÇÊúÄÁªàËøòÊòØ‰∏§‰ΩçÂ§ß‰Ω¨Â∏¶ÁùÄÊàë‰∏Ä‰∏™ËèúÈ∏°ÂãâÂº∫Êãø‰∫Ü‰∏™Â•ñ„ÄÇÊ±Ç‰∏ãÂπ¥Âà´ÂÜçÊãâÊàë‰∫Ü„ÄÇ</p><p>Âà∞‰∫Ü‰∏âÊúàÂ∫ïÂ∞±ÂºÄÂßã‰∏äËØæ‰∫ÜÔºåÈÄöÂ∏∏Á¨¨‰∏Ä‰∏™ÊòüÊúüÈÉΩÊòØ‰ªãÁªçËØæÁ®ãÔºåÂøÖÈ°ªË¶ÅÂê¨ÂïäÔºåÁßçÁßçÂéüÂõ†„ÄÇ‰∏ÄÂºÄÂßãÁöÑÈÇ£Âá†‰∏™ÊòüÊúüËøòÊòØÂæàËÆ§ÁúüÁöÑÂê¨ËØæÁöÑÔºåÂêéÈù¢Â∞±‰∏çÂøçÁõ¥ËßÜ‰∫Ü„ÄÇschool ÁâπËâ≤ÂéüÂõ†ÔºåÊ∞¥ËØæÂæàÂ§ö„ÄÇËøôÊó∂ÂÄôÁΩëËØæÁöÑ‰ºòÂäøÂ∞±Âá∏ÊòæÂá∫Êù•‰∫Ü„ÄÇËØùËôΩËøô‰πàËØ¥Ôºå‰ΩÜÊòØËã±ËØ≠ËøòÊòØÂæóÂ•ΩÂ•ΩÂ≠¶„ÄÇ</p><p>ÂõõÊúà‰ªΩÂºÄÂßãÂáÜÂ§áÂ≠¶Ê†°ÁöÑÊñ∞ÁîüËµõ„ÄÇCrypto ‰∏ç‰ºöÂá∫È¢ò„ÄÇ‰∫éÊòØÁõ¥Êé•Áî®‰∫Ü‰∏ä‰∏ÄÂπ¥Ê†°ËµõÁöÑÊ®°ÊùøÔºå‰∏ÄÊ≥¢‰∏âÊäòÔºåÊúÄÂêéÂº∫Ë°åÂáëÂá∫‰∏âÈÅìÈ¢òÔºåÈöæÂ∫¶Ëøò‰∏çÂ∞èÔºåÁõ¥Êé•‰∏¢Âà∞Âπ≥Âè∞ÔºåÊ≤°‰∫∫ÂÅöÂá∫Êù• 555</p><p>Â§ßÊ¶ÇÂõõÊúà‰∏≠Êó¨ÔºåÂÆ∂Èáå‰∫∫Âá∫‰∫ãÊÉÖ‰∫ÜÔºåÂøÉÊÄÅÊúâÁÇπÂ¥©Ôºå‰πãÂêéÁÆóÊòØÂãâÂãâÂº∫Âº∫Âú∞Âú®Â≠¶‰π†Âêß„ÄÇ</p><p>Âà∞‰∫Ü‰∫îÊúà‰ªΩÔºåÊï¥‰∏™‰∫∫Âã§Âø´‰∫ÜÔºåÂ≠¶ÂæóÊå∫Âø´„ÄÇÊää Crypto ÁöÑÂü∫Á°ÄËøá‰∫Ü‰∏ÄÈÅçÔºåÊâì‰∏ã‰∫ÜÂá†Âú∫ÊØîËµõÔºåÁúã‰∫Ü‰∏çÂ∞ëpaperÔºåÊî∂Ëé∑ËøòÊòØÊå∫Â§ßÁöÑÔºåÂèØÊÉúÊ≤°ÊúâËøõÂà∞Á∫ø‰∏ã„ÄÇ‰∏Ä‰∏™Èòü‰ºçÔºå‰∏âÁº∫‰∏ÄÔºåÂä†‰∏äËøõÁ∫ø‰∏ãÁöÑÁßçÁßçÂõ∞ÈöæÔºåÁ¶ªÁõÆÊ†áËøòÊòØÂæàËøúÂïä„ÄÇ</p><p>ÂÖ≠Êúà‰ªΩ‰∏ªË¶ÅÂú®ÂáÜÂ§áÂêÑÁßëÁöÑËÄÉËØïÔºåÂÖ®ÂäõÂ§ç‰π†ÔºåÊØïÁ´üËøòÊòØÊÉ≥Ê∑∑‰∏™Â•ñÂ≠¶Èáë„ÄÇÁé∞Âú®ÊÉ≥ÊÉ≥Ôºå‰∏çÁü•‰∏çËßâÔºåÂ∑≤ÁªèÂú®ÂÆ∂ÂçäÂπ¥„ÄÇ„ÄÇ„ÄÇÂ∏åÊúõÂø´Âø´ÂºÄÂ≠¶„ÄÇ</p><h1 id="ÊÑüÊÉ≥"><a class="markdownIt-Anchor" href="#ÊÑüÊÉ≥"></a> ÊÑüÊÉ≥</h1><p>Â§ßÂ≠¶Â∑≤ÁªèËøáÂéª‰∏ÄÂçäÔºåÂ∫ÜÂπ∏Ëá™Â∑±Ëøô‰∏ÄÂπ¥Ê≤°ÊúâÊµ™Ë¥πÔºå‰ΩÜ‰πüÂæàÂèØÊÉúÔºåÊ≤°ÊúâËææÂà∞Ëá™Â∑±È¢ÑÊúüÁöÑÁõÆÊ†á„ÄÇÊÄé‰πàËØ¥Âë¢ÔºåËá™Â∑±ÂΩìÂàùÁöÑÁõÆÊ†áÂÖ∂ÂÆûÂ∑≤ÁªèÊîπÂèò‰∫ÜÂêßÔºåÁé∞ÂÆû‰∏≠ÁöÑÂèòÂåñÁöÑÂ§™Âø´ÔºåËÄå‰∏îËá™Â∑±ÂΩìÂàùÁöÑÂÜ≥ÂøÉ‰ºº‰πé‰πüÊ≤°ÊúâÈÇ£‰πàÂùöÂÆö„ÄÇËµ∞‰∏ÄÊ≠•Áúã‰∏ÄÊ≠•ÂêßÔºåÊØïÁ´ü‰∏çÊÉ≥Êµ™Ë¥πËøôÂá†Âπ¥ÂÆùË¥µÁöÑÊó∂Èó¥„ÄÇ</p><h1 id="Â±ïÊúõ"><a class="markdownIt-Anchor" href="#Â±ïÊúõ"></a> Â±ïÊúõ</h1><p>Áî®Êüê‰∫∫ÁöÑËØùÔºö‚ÄúÂ∞ëËØ¥ËØùÔºåÂ§öÂÅö‰∫ã„ÄÇÂÖâËØ¥‰∏çÁªÉÂÅáÊääÂºèÔºåË¶ÅÂã§Â•ãÔºåÂãá‰∫éÂÆûË∑µ„ÄÇ‚Äù</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;2020 Â∑≤ÁªèËøáÂçäÔºåÊñ∞Âπ¥ÁöÑÈíüÂ£∞‰ªø‰Ωõ‰ªçÁÑ∂Ëê¶ÁªïÂú®ËÄ≥Ëæπ„ÄÇÊó∂Èó¥ËøáÂæóÂ§™Âø´ÔºåÁïô‰∏ãÁöÑÂ§™Â∞ë„ÄÇ&lt;/p&gt;
&lt;h1 id=&quot;ÂõûÈ°æ&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#ÂõûÈ°æ&quot;&gt;&lt;/a&gt; ÂõûÈ°æ&lt;/h1&gt;
&lt;p&gt;‰ªäÂπ¥ÁúüÁöÑÂæàÁâπÂà´ÂïäÔºå‰∫åÊúà‰ªΩÁöÑÊó∂ÂÄôËøòÊä±ÁùÄÂõûÂ≠¶Ê†°‰∏äËØæÁöÑÊÉ≥Ê≥ï
      
    
    </summary>
    
    
    
      <category term="Personal Development" scheme="https://buki-freak.github.io/tags/Personal-Development/"/>
    
  </entry>
  
  <entry>
    <title>das-CTF&amp;GK-CTF-2020-Writeup</title>
    <link href="https://buki-freak.github.io/2020/05/24/das-CTF-GK-CTF-2020-Writeup/"/>
    <id>https://buki-freak.github.io/2020/05/24/das-CTF-GK-CTF-2020-Writeup/</id>
    <published>2020-05-24T01:30:24.000Z</published>
    <updated>2020-08-03T03:26:26.371Z</updated>
    
    <content type="html"><![CDATA[<p>Only writeup in Crypto.</p><h1 id="gkctf"><a class="markdownIt-Anchor" href="#gkctf"></a> GKCTF</h1><h2 id="Â∞èÂ≠¶ÁîüÁöÑÂØÜÁ†ÅÂ≠¶solved"><a class="markdownIt-Anchor" href="#Â∞èÂ≠¶ÁîüÁöÑÂØÜÁ†ÅÂ≠¶solved"></a> Â∞èÂ≠¶ÁîüÁöÑÂØÜÁ†ÅÂ≠¶(Solved)</h2><p>Pretty easy affince cipher. Both keys are given.</p><h2 id="babycryptosolved"><a class="markdownIt-Anchor" href="#babycryptosolved"></a> babycrypto(Solved)</h2><p>Partial high bits of p is known.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use sage to run the script</span></span><br><span class="line"><span class="comment"># Reference: https://www.jianshu.com/p/1a0e876d5929</span></span><br><span class="line"><span class="keyword">from</span> sage.all <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># All variables are in hex</span></span><br><span class="line">n = <span class="number">0xb119849bc4523e49c6c038a509a74cda628d4ca0e4d0f28e677d57f3c3c7d0d876ef07d7581fe05a060546fedd7d061d3bc70d679b6c5dd9bc66c5bdad8f2ef898b1e785496c4989daf716a1c89d5c174da494eee7061bcb6d52cafa337fc2a7bba42c918bbd3104dff62ecc9d3704a455a6ce282de0d8129e26c840734ffd302bec5f0a66e0e6d00b5c50fa57c546cff9d7e6a978db77997082b4cb927df9847dfffef55138cb946c62c9f09b968033745b5b6868338c64819a8e92a827265f9abd409359a9471d8c3a2631b80e5b462ba42336717700998ff38536c2436e24ac19228cd2d7a909ead1a8494ff6c3a7151e888e115b68cc6a7a8c6cf8a6c005</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Padding zeros to p --&gt; p4</span></span><br><span class="line">p4 = <span class="number">0xe4e4b390c1d201dae2c00a4669c0865cc5767bc444f5d310f3cfc75872d96feb89e556972c99ae20753e3314240a52df5dccd076a47c6b5d11b531b92d901b2b512aeb0b263bbfd624fe3d52e5e238beeb581ebe012b2f176a4ffd1e0d2aa8c4d3a2656573b727d4d3136513a931428b00000000000000000000000000000000</span></span><br><span class="line">cipher = <span class="number">1422566584480199878714663051468143513667934216213366733442059106529451931078271460363335887054199577950679102659270179475911101747625120544429262334214483688332111552004535828182425152965223599160129610990036911146029170033592055768983427904835395850414634659565092191460875900237711597421272312032796440948509724492027247376113218678183443222364531669985128032971256792532015051829041230203814090194611041172775368357197854451201260927117792277559690205342515437625417792867692280849139537687763919269337822899746924269847694138899165820004160319118749298031065800530869562704671435709578921901495688124042302500361</span></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">kbits = <span class="number">128</span>  <span class="comment"># kbits represent the loss bits</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))  <span class="comment"># Create a polynomial ring</span></span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:        </span><br><span class="line">    p = p4 + int(roots[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">assert</span> n % p == <span class="number">0</span></span><br><span class="line">    q = n / int(p)</span><br><span class="line">    phin = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">    d = inverse_mod(e2,phin)</span><br><span class="line">    flag = pow(cipher,d,n)</span><br><span class="line">    <span class="keyword">print</span> long_to_bytes(flag)</span><br></pre></td></tr></table></figure><h2 id="Ê±âÂ≠óÁöÑÂØÜÁ†Åsolved"><a class="markdownIt-Anchor" href="#Ê±âÂ≠óÁöÑÂØÜÁ†Åsolved"></a> Ê±âÂ≠óÁöÑÂØÜÁ†Å(Solved)</h2><p>ÂΩìÈì∫ÂØÜÁ†Å+Substitution Cipher</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dic = [<span class="number">66</span>, <span class="number">74</span>, <span class="number">62</span>, <span class="number">67</span>, <span class="number">118</span>, <span class="number">83</span>, <span class="number">72</span>, <span class="number">77</span>, <span class="number">86</span>, <span class="number">55</span>, <span class="number">71</span>, <span class="number">57</span>, <span class="number">82</span>, <span class="number">57</span>, <span class="number">64</span>, <span class="number">63</span>, <span class="number">51</span>, <span class="number">107</span>]</span><br><span class="line">delta = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">    print(chr(i+delta), end=<span class="string">""</span>)</span><br><span class="line">    delta += <span class="number">1</span></span><br><span class="line"><span class="comment"># FLAG&#123;YOU_ARE_GOOD&#125;</span></span><br></pre></td></tr></table></figure><h2 id="backdoorunsolved"><a class="markdownIt-Anchor" href="#backdoorunsolved"></a> Backdoor(Unsolved)</h2><p>Remain confused</p><h1 id="dasctf"><a class="markdownIt-Anchor" href="#dasctf"></a> DASCTF</h1><h2 id="bbcryptosolved"><a class="markdownIt-Anchor" href="#bbcryptosolved"></a> bbcrypto(Solved)</h2><p><strong><a href="http://quiz.py" target="_blank" rel="noopener">quiz.py</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> A,SALT</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(m, a, si)</span>:</span></span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)):</span><br><span class="line">        c+=hex(((ord(m[i])) * a + ord(next(si))) % <span class="number">128</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    m = <span class="string">'flag&#123;********************************&#125;'</span></span><br><span class="line">    a = A</span><br><span class="line">    salt = SALT</span><br><span class="line">    <span class="keyword">assert</span>(len(salt)==<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">assert</span>(salt.isalpha())</span><br><span class="line">    si = cycle(salt.lower())</span><br><span class="line">    print(<span class="string">"ÊòéÊñáÂÜÖÂÆπ‰∏∫Ôºö"</span>)</span><br><span class="line">    print(m)</span><br><span class="line">    print(<span class="string">"Âä†ÂØÜÂêéÁöÑÂØÜÊñá‰∏∫Ôºö"</span>)</span><br><span class="line">    c=encrypt(m, a, si)</span><br><span class="line">    print(c)</span><br><span class="line">    <span class="comment">#Âä†ÂØÜÂêéÁöÑÂØÜÊñá‰∏∫Ôºö</span></span><br><span class="line">    <span class="comment">#177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d</span></span><br></pre></td></tr></table></figure><p>The length of salt is 3 and we have already known that the plain starts with ‚Äúflag{‚Äù. Solve linear congruent equations to get the salt.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">"177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d"</span></span><br><span class="line">li_c = [int(c[i:i+<span class="number">2</span>], <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(c), <span class="number">2</span>)]</span><br><span class="line"><span class="comment"># print(li_c)</span></span><br><span class="line">m = <span class="string">"flag&#123;"</span></span><br><span class="line">d_c = li_c[<span class="number">3</span>] - li_c[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># print(d_c)</span></span><br><span class="line">d_m = ord(m[<span class="number">3</span>]) - ord(m[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># print(d_m)  # a = 57 mod 128</span></span><br><span class="line">a = <span class="number">57</span></span><br><span class="line"><span class="comment"># print((li_c[0] - a * ord(m[0])) % 128)</span></span><br><span class="line"><span class="comment"># print(chr(97))  y1 = 'a'</span></span><br><span class="line"><span class="comment"># print((li_c[1] - a * ord(m[1])) % 128)</span></span><br><span class="line"><span class="comment"># print(chr(104)) y2 = 'h'</span></span><br><span class="line"><span class="comment"># print((li_c[2] - a * ord(m[2])) % 128)</span></span><br><span class="line"><span class="comment"># print(chr(104))  # y3 = 'h'</span></span><br><span class="line"><span class="comment"># print((li_c[3] - a * ord(m[3])) % 128)</span></span><br><span class="line">m = <span class="string">""</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">inv_a = invert(a, <span class="number">128</span>)</span><br><span class="line">key = itertools.cycle(<span class="string">"ahh"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> li_c:</span><br><span class="line">    m += chr(((i - ord(next(key))) * inv_a) % <span class="number">128</span>)</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure><h2 id="encrypt_imgsolved"><a class="markdownIt-Anchor" href="#encrypt_imgsolved"></a> encrypt_img(Solved)</h2><p><strong><a href="http://quiz.py" target="_blank" rel="noopener">quiz.py</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> array</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> Key</span><br><span class="line"></span><br><span class="line">Plaintext1 = <span class="string">"RC4IsInteresting"</span></span><br><span class="line">Plaintext2 = <span class="string">"ThisIsAEasyGame"</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RC4</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, Key)</span>:</span></span><br><span class="line">        self.S = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)]  <span class="comment"># 0 - 255</span></span><br><span class="line">        self.K = [ord(Key[i % len(Key)])*<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)]   <span class="comment"># KEY * 2(0-255)</span></span><br><span class="line">        self.I, self.J = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        self.KSA()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">KSA</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            j = (i+self.K[i]+self.S[i]) % <span class="number">256</span></span><br><span class="line">            self.S[i], self.S[j] = self.S[j], self.S[i]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.I = (self.I+<span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        self.J = (self.J+self.S[self.I]) % <span class="number">256</span></span><br><span class="line">        self.S[self.J], self.S[self.I] = self.S[self.I], self.S[self.J]</span><br><span class="line">        tmp = (self.S[self.J] + self.S[self.I]) % <span class="number">256</span></span><br><span class="line">        <span class="keyword">return</span> self.S[tmp]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Encrypt</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, plain)</span>:</span></span><br><span class="line">        <span class="keyword">global</span> cnt</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        self.rc4 = RC4(Key)</span><br><span class="line">        self.testRC4(plain)</span><br><span class="line">        flag_file = Image.open(<span class="string">r"flag.png"</span>)</span><br><span class="line">        img = array(flag_file)</span><br><span class="line">        self.enc(img)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">testRC4</span><span class="params">(self, plain)</span>:</span></span><br><span class="line">        ciphertext = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">            ciphertext = (ciphertext &lt;&lt; <span class="number">8</span>)+ord(i) ^ self.rc4.next()</span><br><span class="line">        print(<span class="string">"ciphertext&#123;&#125; = &#123;&#125;"</span>.format(cnt, ciphertext))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enc</span><span class="params">(self, img)</span>:</span></span><br><span class="line">        a, b, _ = img.shape</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, a):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>, b):</span><br><span class="line">                pixel = img[x, y]</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">                    pixel[i] = pixel[i] ^ self.rc4.next()</span><br><span class="line">                img[x][y] = pixel</span><br><span class="line">        enc = Image.fromarray(img)</span><br><span class="line">        enc.save(<span class="string">"enc&#123;&#125;.png"</span>.format(cnt))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Encrypt(Plaintext1)</span><br><span class="line">Encrypt(Plaintext2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ciphertext1 = 12078640933356268898100798377710191641</span></span><br><span class="line"><span class="comment"># ciphertext2 = 79124196547094980420644350061749775</span></span><br></pre></td></tr></table></figure><p><strong>enc1.png</strong></p><p><strong>enc2.png</strong></p><p><strong>Stream Cipher Insertion Attack</strong></p><p>Such a pity that I didn‚Äôt figure it out at that time. From two groups of plaintexts and ciphertexts we can recover keystream at the start. However, the second keystream has one bit less than the first one, from which we easily can retrieve m0, then k1, after that m1 and so on.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">plaintext1 = "RC4IsInteresting"</span></span><br><span class="line"><span class="string">plaintext2 = "ThisIsAEasyGame"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ciphertext1 = 12078640933356268898100798377710191641</span></span><br><span class="line"><span class="string">ciphertext2 = 79124196547094980420644350061749775</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">key1 = []</span></span><br><span class="line"><span class="string">for i in range(len(plaintext1) - 1, -1, -1):</span></span><br><span class="line"><span class="string">     key1 = [ord(plaintext1[i]) ^ (ciphertext1 &amp; 0xff)] + key1</span></span><br><span class="line"><span class="string">     ciphertext1 &gt;&gt;= 8</span></span><br><span class="line"><span class="string">print(key1)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">key2 = []</span></span><br><span class="line"><span class="string">for i in range(len(plaintext2) - 1, -1, -1):</span></span><br><span class="line"><span class="string">     key2 = [ord(plaintext2[i]) ^ (ciphertext2 &amp; 0xff)] + key2</span></span><br><span class="line"><span class="string">     ciphertext2 &gt;&gt;= 8</span></span><br><span class="line"><span class="string">print(key2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># [91, 85, 118, 176, 158, 228, 216, 21, 145, 123, 89, 181, 165, 203, 106, 126]</span></span><br><span class="line"><span class="string"># [91, 85, 118, 176, 158, 228, 216, 21, 145, 123, 89, 181, 165, 203, 106]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># Suppose the bit length of the flag.png is n bits, key1 and key2 can be written like:</span></span><br><span class="line"><span class="comment"># key1: k1, k2, ..., kn</span></span><br><span class="line"><span class="comment"># key2: k0, k1, ..., k(n-1)</span></span><br><span class="line"><span class="comment"># Above we have already known k0 is 126, which is the last key of plaintext2,</span></span><br><span class="line"><span class="comment"># we can retrieve m0, then k1, after that m1 and so on</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> array</span><br><span class="line"></span><br><span class="line">img1 = array(Image.open(<span class="string">r"./enc1.png"</span>))</span><br><span class="line">img2 = array(Image.open(<span class="string">r"./enc2.png"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recovery_img</span><span class="params">(im1, im2, k)</span>:</span></span><br><span class="line">    x1, y1, z1 = im1.shape</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(x1):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(y1):</span><br><span class="line">            pixel1 = im1[i, j]</span><br><span class="line">            pixel2 = im2[i, j]</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">                pixel2[_] = pixel2[_] ^ k</span><br><span class="line">                k = pixel1[_] ^ pixel2[_]</span><br><span class="line">    im2 = Image.fromarray(im2)</span><br><span class="line">    im2.save(<span class="string">"dec.png"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">recovery_img(img1, img2, <span class="number">126</span>)</span><br></pre></td></tr></table></figure><h2 id="babylcgsolved"><a class="markdownIt-Anchor" href="#babylcgsolved"></a> babyLCG(Solved)</h2><p><strong><a href="http://quiz.py" target="_blank" rel="noopener">quiz.py</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.a = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.b = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.m = getPrime(<span class="number">32</span>)</span><br><span class="line">        self.seed = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.seed = (self.a*self.seed+self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;"</span>.format(self.a, self.b, self.m))</span><br><span class="line">        print(<span class="string">"state1 = &#123;&#125;"</span>.format(self.next()))</span><br><span class="line">        print(<span class="string">"state2 = &#123;&#125;"</span>.format(self.next()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DH</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.lcg = LCG()</span><br><span class="line">        self.lcg.output()</span><br><span class="line">        self.g = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        self.m = getPrime(<span class="number">256</span>)</span><br><span class="line">        self.A, self.a = self.gen_AB()</span><br><span class="line">        self.B, self.b = self.gen_AB()</span><br><span class="line">        self.key = pow(self.A, self.b, self.m)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_AB</span><span class="params">(self)</span>:</span></span><br><span class="line">        x = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">            x += <span class="string">'1'</span> <span class="keyword">if</span> self.lcg.next() % <span class="number">2</span> <span class="keyword">else</span> <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">return</span> pow(self.g, int(x, <span class="number">2</span>), self.m), int(x, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DH = DH()</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">print(<span class="string">"g = &#123;&#125;\nA = &#123;&#125;\nB = &#123;&#125;\nM = &#123;&#125;"</span>.format(DH.g, DH.A, DH.B, DH.m))</span><br><span class="line">print(<span class="string">"Cipher = &#123;&#125;"</span>.format(flag ^ DH.key))</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">a = 3844066521</span></span><br><span class="line"><span class="string">b = 3316005024</span></span><br><span class="line"><span class="string">m = 2249804527</span></span><br><span class="line"><span class="string">state1 = 16269</span></span><br><span class="line"><span class="string">state2 = 4249</span></span><br><span class="line"><span class="string">g = 183096451267674849541594370111199688704</span></span><br><span class="line"><span class="string">A = 102248652770540219619953045171664636108622486775480799200725530949685509093530</span></span><br><span class="line"><span class="string">B = 74913924633988481450801262607456437193056607965094613549273335198280176291445</span></span><br><span class="line"><span class="string">M = 102752586316294557951738800745394456033378966059875498971396396583576430992701</span></span><br><span class="line"><span class="string">Cipher = 13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><p><strong>LCG+Diffie Hellman Exchange Key</strong></p><p>The seed is too small ,as a result, we use brute-force attack to get the seed and recover the key. When we XOR the cipher with the key, the plain is figured out.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">a = 3844066521</span></span><br><span class="line"><span class="string">b = 3316005024</span></span><br><span class="line"><span class="string">m = 2249804527</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.a = <span class="number">3844066521</span></span><br><span class="line">        self.b = <span class="number">3316005024</span></span><br><span class="line">        self.m = <span class="number">2249804527</span></span><br><span class="line">        self.seed = <span class="number">714405490</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.seed = (self.a*self.seed+self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;"</span>.format(self.a, self.b, self.m))</span><br><span class="line">        print(<span class="string">"state1 = &#123;&#125;"</span>.format(self.next()))</span><br><span class="line">        print(<span class="string">"state2 = &#123;&#125;"</span>.format(self.next()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DH</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.lcg = LCG()</span><br><span class="line">        self.lcg.output()</span><br><span class="line">        self.g = <span class="number">183096451267674849541594370111199688704</span></span><br><span class="line">        self.m = <span class="number">102752586316294557951738800745394456033378966059875498971396396583576430992701</span></span><br><span class="line">        self.A, self.a = self.gen_AB()  <span class="comment"># a private key</span></span><br><span class="line">        self.B, self.b = self.gen_AB()  <span class="comment"># b private key</span></span><br><span class="line">        self.key = pow(self.A, self.b, self.m)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_AB</span><span class="params">(self)</span>:</span></span><br><span class="line">        x = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">            x += <span class="string">'1'</span> <span class="keyword">if</span> self.lcg.next() % <span class="number">2</span> <span class="keyword">else</span> <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">return</span> pow(self.g, int(x, <span class="number">2</span>), self.m), int(x, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">def next(x):</span></span><br><span class="line"><span class="string">    return (x * a + b) % m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def brute_force():</span></span><br><span class="line"><span class="string">    for i in range(1&lt;&lt;32):</span></span><br><span class="line"><span class="string">        if i % 10000000 == 0:</span></span><br><span class="line"><span class="string">            print("count:", i)</span></span><br><span class="line"><span class="string">        res = next(i)</span></span><br><span class="line"><span class="string">        if (res &gt;&gt; 16) == 16269 and (next(res) &gt;&gt; 16) == 4249:</span></span><br><span class="line"><span class="string">            print(i)</span></span><br><span class="line"><span class="string">            break</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DH = DH()</span><br><span class="line">cipher = <span class="number">13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703</span></span><br><span class="line">print(<span class="string">"g = &#123;&#125;\nA = &#123;&#125;\nB = &#123;&#125;\nM = &#123;&#125;"</span>.format(DH.g, DH.A, DH.B, DH.m))</span><br><span class="line">print(<span class="string">"flag = &#123;&#125;"</span>.format(cipher ^ DH.key))</span><br><span class="line"><span class="comment"># flag = 13040004482819966666226297285938773653367957972934959074317939536564198335643452104954492541</span></span><br><span class="line"><span class="comment"># flag&#123;4dfe14e0c6c21ffcf5a3b4f0ed1911f6&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">a = 3844066521</span></span><br><span class="line"><span class="string">b = 3316005024</span></span><br><span class="line"><span class="string">m = 2249804527</span></span><br><span class="line"><span class="string">state1 = 16269</span></span><br><span class="line"><span class="string">state2 = 4249</span></span><br><span class="line"><span class="string">g = 183096451267674849541594370111199688704</span></span><br><span class="line"><span class="string">A = 102248652770540219619953045171664636108622486775480799200725530949685509093530</span></span><br><span class="line"><span class="string">B = 74913924633988481450801262607456437193056607965094613549273335198280176291445</span></span><br><span class="line"><span class="string">M = 102752586316294557951738800745394456033378966059875498971396396583576430992701</span></span><br><span class="line"><span class="string">Cipher = 13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><h2 id="knapsacksolved"><a class="markdownIt-Anchor" href="#knapsacksolved"></a> Knapsack(Solved)</h2><p><strong><a href="http://quiz.py" target="_blank" rel="noopener">quiz.py</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genKey</span><span class="params">(length)</span>:</span></span><br><span class="line">    A, B = getPrime(<span class="number">64</span>), getPrime(<span class="number">1025</span>)</span><br><span class="line"></span><br><span class="line">    Rn = getPrime(<span class="number">1024</span>)</span><br><span class="line">    key1 = [Rn//<span class="number">2</span>**i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, length+<span class="number">1</span>)]</span><br><span class="line">    key2 = [i*A % B <span class="keyword">for</span> i <span class="keyword">in</span> key1]</span><br><span class="line">    <span class="keyword">return</span> key1,key2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(text,key)</span>:</span></span><br><span class="line">    Sum=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(text)):</span><br><span class="line">        Sum+=int(text[i])*key[i]</span><br><span class="line">    <span class="keyword">return</span> Sum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(Ciper,Key)</span>:</span></span><br><span class="line">    f1=open(<span class="string">"pub.txt"</span>,<span class="string">"w"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(Key)):</span><br><span class="line">        f1.write(str(Key[i])+<span class="string">'\n'</span>)</span><br><span class="line">    f2=open(<span class="string">"cip.txt"</span>,<span class="string">"w"</span>)</span><br><span class="line">    f2.write(hex(Ciper))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FLAG = bin(bytes_to_long(flag.encode()))[<span class="number">2</span>:]</span><br><span class="line">Key1,Key2 = genKey(len(FLAG))</span><br><span class="line">Ciper = encrypt(FLAG,Key1)</span><br><span class="line">save(Ciper,Key2)</span><br></pre></td></tr></table></figure><p><strong>cip.txt</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">a</span> <span class="keyword">long</span> hex <span class="keyword">string</span></span><br></pre></td></tr></table></figure><p><strong>pub.txt</strong></p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">1015 </span>public keys</span><br></pre></td></tr></table></figure><p>The last few key in pub.txt is too small, which actually is the original private key. We can use them to recover the original private key.</p><h2 id="backpackerunsolved"><a class="markdownIt-Anchor" href="#backpackerunsolved"></a> backpacker(Unsolved)</h2><p>Remain confused</p><h1 id="what-i-have-done"><a class="markdownIt-Anchor" href="#what-i-have-done"></a> <strong>What I have done</strong></h1><p>Finish learning symmetric cipher and the first chapter of Network Introduction.</p><h1 id="things-to-improve"><a class="markdownIt-Anchor" href="#things-to-improve"></a> Things to Improve</h1><ul><li>Don‚Äôt be panic when encountering a challenge that is never met</li><li>Be more concentrated on study</li><li>LLL algorithm</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Only writeup in Crypto.&lt;/p&gt;
&lt;h1 id=&quot;gkctf&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#gkctf&quot;&gt;&lt;/a&gt; GKCTF&lt;/h1&gt;
&lt;h2 id=&quot;Â∞èÂ≠¶ÁîüÁöÑÂØÜÁ†ÅÂ≠¶solved&quot;&gt;&lt;a class=&quot;ma
      
    
    </summary>
    
    
    
      <category term="Writeup" scheme="https://buki-freak.github.io/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>Npu-CTF-2020-Review</title>
    <link href="https://buki-freak.github.io/2020/05/12/Npu-CTF-2020-Review/"/>
    <id>https://buki-freak.github.io/2020/05/12/Npu-CTF-2020-Review/</id>
    <published>2020-05-12T13:20:15.000Z</published>
    <updated>2020-08-03T03:26:42.361Z</updated>
    
    <content type="html"><![CDATA[<p>Only review in Crypto.</p><h1 id="what-does-the-tag-mean"><a class="markdownIt-Anchor" href="#what-does-the-tag-mean"></a> What does the tag mean</h1><table><thead><tr><th>Status</th><th>Description</th></tr></thead><tbody><tr><td>Solved</td><td>Solved in the competition</td></tr><tr><td>Unlved</td><td>Unsolved in the competition</td></tr></tbody></table><h1 id="mersenne-twisterunsolved"><a class="markdownIt-Anchor" href="#mersenne-twisterunsolved"></a> Mersenne Twister(unsolved)</h1><p>This challenge is related to Mersenne Twister Encryption. However, there are differences between them exactly. Here is the file:</p><p><strong>Mersenne <a href="http://Twiser.py" target="_blank" rel="noopener">Twiser.py</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> hexlify , unhexlify</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag ,seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> len(flag) == <span class="number">26</span></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">7</span>] == <span class="string">'npuctf&#123;'</span></span><br><span class="line"><span class="keyword">assert</span> flag[<span class="number">-1</span>] == <span class="string">'&#125;'</span></span><br><span class="line"></span><br><span class="line">XOR = <span class="keyword">lambda</span> s1 ,s2 : bytes([x1 ^ x2 <span class="keyword">for</span> x1 ,x2 <span class="keyword">in</span> zip(s1 , s2)])</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mt73991</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self , seed)</span>:</span></span><br><span class="line">        self.state = [seed] + [<span class="number">0</span>] * <span class="number">232</span></span><br><span class="line">        self.flag = <span class="number">0</span></span><br><span class="line">        self.srand()</span><br><span class="line">        self.generate()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">srand</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">232</span>):</span><br><span class="line">            self.state[i+<span class="number">1</span>] = <span class="number">1812433253</span> * (self.state[i] ^ (self.state[i] &gt;&gt; <span class="number">27</span>)) - i</span><br><span class="line">            self.state[i+<span class="number">1</span>] &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">233</span>):</span><br><span class="line">            y = (self.state[i] &amp; <span class="number">0x80000000</span>) | (self.state[(i+<span class="number">1</span>)%<span class="number">233</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">            temp = y &gt;&gt; <span class="number">1</span></span><br><span class="line">            temp ^= self.state[(i + <span class="number">130</span>) % <span class="number">233</span>]</span><br><span class="line">            <span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">                temp ^= <span class="number">0x9908f23f</span></span><br><span class="line">            self.state[i] = temp</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getramdanbits</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.flag == <span class="number">233</span>:</span><br><span class="line">            self.generate()</span><br><span class="line">            self.flag = <span class="number">0</span></span><br><span class="line">        bits = self.Next(self.state[self.flag]).to_bytes(<span class="number">4</span> , <span class="string">'big'</span>)</span><br><span class="line">        self.flag += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> bits</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Next</span><span class="params">(self , tmp)</span>:</span></span><br><span class="line">        tmp ^= (tmp &gt;&gt; <span class="number">11</span>)</span><br><span class="line">        tmp ^= (tmp &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9ddf4680</span></span><br><span class="line">        tmp ^= (tmp &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc65400</span></span><br><span class="line">        tmp ^= (tmp &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x34adf670</span></span><br><span class="line">        <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(key , plain)</span>:</span></span><br><span class="line">    tmp = md5(plain).digest()</span><br><span class="line">    <span class="keyword">return</span> hexlify(XOR(tmp , key))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    flag = flag.encode()</span><br><span class="line">    random = mt73991(seed)</span><br><span class="line">    f = open(<span class="string">'./cipher.txt'</span> , <span class="string">'wb'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">        key = <span class="string">b''</span>.join([random.getramdanbits() <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">4</span>)])</span><br><span class="line">        cipher = encrypt(key , chr(i).encode())</span><br><span class="line">        f.write(cipher)</span><br></pre></td></tr></table></figure><p><strong>cipher.txt</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">an</span> <span class="number">832</span> <span class="keyword">bytes</span> <span class="keyword">long</span> hex <span class="keyword">string</span></span><br></pre></td></tr></table></figure><h2 id="explanation"><a class="markdownIt-Anchor" href="#explanation"></a> Explanation</h2><p>Mersenne Twister is a kind of PRNG, whose derives from the fact that its period length is chosen to be a Mersenne Prime. This Mersenne Twister challenge has a 32-bit length.</p><h2 id="condition"><a class="markdownIt-Anchor" href="#condition"></a> Condition</h2><p>Only a few conditions are given.</p><blockquote><p>the encryption result in cipher.txt</p><p>the period length</p><p>partial flag</p><p>the length of the flag</p><p>encryption function</p></blockquote><h2 id="details"><a class="markdownIt-Anchor" href="#details"></a> Details</h2><p>Given that the first part of the flag is ‚Äúnpuctf{‚Äù, which is a 7 bytes long string, we can retrieve the first 28 generated states with the according cipher in cipher.txt. Since we also know the last byte of the string(&quot;}&quot;) and the length of the string, we can easily retrieve the 100th~103th generated states.</p><p>Then we look into the generate function.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">233</span>):</span><br><span class="line">        y = (self.state[i] &amp; <span class="number">0x80000000</span>) | (self.state[(i + <span class="number">1</span>) % <span class="number">233</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">        temp = y &gt;&gt; <span class="number">1</span></span><br><span class="line">        temp ^= self.state[(i + <span class="number">130</span>) % <span class="number">233</span>]</span><br><span class="line">        <span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">            temp ^= <span class="number">0x9908f23f</span></span><br><span class="line">        self.state[i] = temp</span><br></pre></td></tr></table></figure><p>Suppose that i equals to 103, we try to write down that situation.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">233</span>):</span><br><span class="line">        y = (self.state[<span class="number">103</span>] &amp; <span class="number">0x80000000</span>) | (self.state[(<span class="number">104</span>) % <span class="number">233</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">        temp = y &gt;&gt; <span class="number">1</span>  <span class="comment"># 1</span></span><br><span class="line">        temp ^= self.state[(<span class="number">0</span>) % <span class="number">233</span>]  <span class="comment"># 2</span></span><br><span class="line">        <span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">            temp ^= <span class="number">0x9908f23f</span></span><br><span class="line">        self.state[<span class="number">103</span>] = temp  <span class="comment"># 3</span></span><br></pre></td></tr></table></figure><p>In this situation, it is possible for us to retrieve the104th initial state, which means that we can get the seed through inversing. There are two possibilities in this situation(state[104] is odd or even). We try to draw a table.</p><table><thead><tr><th>possibilites</th><th>hb(1)</th><th>hb(2)</th><th>hb(3)</th></tr></thead><tbody><tr><td>even</td><td>0</td><td>0</td><td>0</td></tr><tr><td>odd</td><td>0</td><td>0</td><td>1</td></tr></tbody></table><p>hb in the table above means the highest bit of the value in the line #n. Based on the fact that the true hb(3) is 0, which is the highest bit of the 103th generated state, it is impossible for the 104th initial state to be odd. Therefore, we can retrieve y and the low 31 bits of the 104 initial state. Since the highest bit is unknown, we can guess it (zero or one). Therefore, there are two possible seeds, which can be judged in the end. Because the seed is retrieved, we can decrypt the cipher easily.(Something just like Symmetric Cipher)</p><p>By the way, the md5 function in encrypt function seems to be useless because it only encrypts one character, for which we can correspondingly generate an md5 dictionary of all printable characters and print the corresponding characters.</p><h2 id="realization"><a class="markdownIt-Anchor" href="#realization"></a> Realization</h2><p>Here is my realization.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">XOR = <span class="keyword">lambda</span> s1, s2: bytes([x1 ^ x2 <span class="keyword">for</span> x1, x2 <span class="keyword">in</span> zip(s1, s2)])</span><br><span class="line">initial_state = [<span class="number">0</span>] * <span class="number">233</span></span><br><span class="line">initial_state2 = [<span class="number">0</span>] * <span class="number">233</span></span><br><span class="line">cipher = [<span class="string">'cef4876036ee8b55aa59bca043725bf3'</span>,</span><br><span class="line">          <span class="string">'50a5e491debdef7ef7d63e9609a288ca'</span>,</span><br><span class="line">          <span class="string">'1e2c82a7fe566bd8709e73c8d495ea50'</span>,</span><br><span class="line">          <span class="string">'4a486ed11189faf8e6fb35617e47d2d1'</span>,</span><br><span class="line">          <span class="string">'ad5e4783e96afeaae9f7104ec477fb39'</span>,</span><br><span class="line">          <span class="string">'fe4ec619bf58289709e15c4449f03fc5'</span>,</span><br><span class="line">          <span class="string">'1cba918cd0ebfdc12376b41e78154064'</span>,</span><br><span class="line">          <span class="string">'82733b3b200826b6c78d86563edaea94'</span>,</span><br><span class="line">          <span class="string">'dccf459a4291517a4b8367d7b4a53aee'</span>,</span><br><span class="line">          <span class="string">'cd7e0accf661bfc726f5ba62e1c0e041'</span>,</span><br><span class="line">          <span class="string">'00108ad32e7d5711f780185cba5cf31d'</span>,</span><br><span class="line">          <span class="string">'328bee84066be4ab9582cf9d4bfe3c6f'</span>,</span><br><span class="line">          <span class="string">'96a7732e1c37d800c90fd46277147f0a'</span>,</span><br><span class="line">          <span class="string">'26c149dcd5eeb0f2df0c075627bc220b'</span>,</span><br><span class="line">          <span class="string">'e5eefdd67186056ac28c21e155a7f247'</span>,</span><br><span class="line">          <span class="string">'664aaecdb498134de274df10114d1f06'</span>,</span><br><span class="line">          <span class="string">'f84dd21820f150d69c9439d909dec0f5'</span>,</span><br><span class="line">          <span class="string">'ccfeab61b62db2ea91d31bc8163ff16c'</span>,</span><br><span class="line">          <span class="string">'7f458006bd5ac4a5f5bfae2770b23ccf'</span>,</span><br><span class="line">          <span class="string">'b7195b76aa0a9aa146831667a7b9fe08'</span>,</span><br><span class="line">          <span class="string">'c19e691afadccb3ca5169ef3fabaa3da'</span>,</span><br><span class="line">          <span class="string">'d47d536e89ed4cee6f788bc969c3ad31'</span>,</span><br><span class="line">          <span class="string">'37850ebfc46a73af2b0c036c3da4b4a1'</span>,</span><br><span class="line">          <span class="string">'6506f499445c604dd73eeb846a52f881'</span>,</span><br><span class="line">          <span class="string">'515a3ad0ab448b4f9ed3e0ab1fffac60'</span>,</span><br><span class="line">          <span class="string">'b223dde6450ba6198e90e14de107aaf2'</span>]</span><br><span class="line"></span><br><span class="line">starts = <span class="string">"npuctf&#123;"</span></span><br><span class="line">ends = <span class="string">"&#125;"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mt73991</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, seed)</span>:</span></span><br><span class="line">        self.state = [seed] + [<span class="number">0</span>] * <span class="number">232</span></span><br><span class="line">        self.flag = <span class="number">0</span></span><br><span class="line">        self.srand()</span><br><span class="line">        self.generate()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">srand</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">232</span>):</span><br><span class="line">            self.state[i + <span class="number">1</span>] = <span class="number">1812433253</span> * (self.state[i] ^ (self.state[i] &gt;&gt; <span class="number">27</span>)) - i</span><br><span class="line">            self.state[i + <span class="number">1</span>] &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">233</span>):</span><br><span class="line">            y = (self.state[i] &amp; <span class="number">0x80000000</span>) | (self.state[(i + <span class="number">1</span>) % <span class="number">233</span>] &amp; <span class="number">0x7fffffff</span>)</span><br><span class="line">            temp = y &gt;&gt; <span class="number">1</span></span><br><span class="line">            temp ^= self.state[(i + <span class="number">130</span>) % <span class="number">233</span>]</span><br><span class="line">            <span class="keyword">if</span> y &amp; <span class="number">1</span>:</span><br><span class="line">                temp ^= <span class="number">0x9908f23f</span></span><br><span class="line">            self.state[i] = temp</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getramdanbits</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.flag == <span class="number">233</span>:</span><br><span class="line">            self.generate()</span><br><span class="line">            self.flag = <span class="number">0</span></span><br><span class="line">        bits = self.Next(self.state[self.flag]).to_bytes(<span class="number">4</span>, <span class="string">'big'</span>)</span><br><span class="line">        self.flag += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> bits</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Next</span><span class="params">(self, tmp)</span>:</span></span><br><span class="line">        tmp ^= (tmp &gt;&gt; <span class="number">11</span>)</span><br><span class="line">        tmp ^= (tmp &lt;&lt; <span class="number">7</span>) &amp; <span class="number">0x9ddf4680</span></span><br><span class="line">        tmp ^= (tmp &lt;&lt; <span class="number">15</span>) &amp; <span class="number">0xefc65400</span></span><br><span class="line">        tmp ^= (tmp &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x34adf670</span></span><br><span class="line">        <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">USMR</span><span class="params">(x, shift, mask)</span>:</span></span><br><span class="line">    res = x</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        res = x ^ (res &gt;&gt; shift &amp; mask)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">USML</span><span class="params">(x, shift, mask)</span>:</span></span><br><span class="line">    res = x</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">        res = x ^ (res &lt;&lt; shift &amp; mask)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inv_Next</span><span class="params">(x)</span>:</span></span><br><span class="line">    x = USMR(x, <span class="number">18</span>, <span class="number">0x34adf670</span>)</span><br><span class="line">    x = USML(x, <span class="number">15</span>, <span class="number">0xefc65400</span>)</span><br><span class="line">    x = USML(x, <span class="number">7</span>, <span class="number">0x9ddf4680</span>)</span><br><span class="line">    x = USR(x, <span class="number">11</span>, <span class="number">0xffffffff</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inv_srand</span><span class="params">(value, index)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(index<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        value += i</span><br><span class="line">        value *= inverse(<span class="number">1812433253</span>, <span class="number">0x100000000</span>)</span><br><span class="line">        value = USR(value, <span class="number">27</span>, <span class="number">0xffffffff</span>)</span><br><span class="line">        value &amp;= <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">USR</span><span class="params">(value, shift, mask)</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i * shift &lt; <span class="number">32</span>:</span><br><span class="line">        partMask = ((<span class="number">0xffffffff</span> &lt;&lt; (<span class="number">32</span> - shift)) &amp; <span class="number">0xffffffff</span>) &gt;&gt; (shift * i)</span><br><span class="line">        part = value &amp; partMask</span><br><span class="line">        value ^= (part &gt;&gt; shift) &amp; mask</span><br><span class="line">        res |= part</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># hash all known characters</span></span><br><span class="line">hash_starts = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> starts:</span><br><span class="line">    hash_starts.append(hashlib.md5(i.encode()).digest())</span><br><span class="line"><span class="comment"># print(hash_starts)</span></span><br><span class="line">hash_ends = hashlib.md5(ends.encode()).digest()</span><br><span class="line"></span><br><span class="line">state = [<span class="number">0</span>] * <span class="number">233</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># first 7 characters</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(starts)):</span><br><span class="line">    key = XOR(hash_starts[i], binascii.unhexlify(cipher[i]))</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">        tmp = inv_Next(bytes_to_long(key[<span class="number">4</span>*j:<span class="number">4</span>*j+<span class="number">4</span>]))</span><br><span class="line">        state[<span class="number">4</span>*i+j] = tmp</span><br><span class="line"><span class="comment"># print(state[:28])  # check pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(key, cipher)</span>:</span></span><br><span class="line">    cipher = binascii.unhexlify(cipher)</span><br><span class="line">    temp = XOR(key, cipher)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> md5_dic:</span><br><span class="line">        <span class="keyword">if</span> temp == i:</span><br><span class="line">            print(string.printable[md5_dic.index(i)], end=<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># the last character</span></span><br><span class="line">key = XOR(hash_ends, binascii.unhexlify(cipher[<span class="number">-1</span>]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    tmp = inv_Next(bytes_to_long(key[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>]))</span><br><span class="line">    state[<span class="number">100</span>+i] = tmp</span><br><span class="line"><span class="comment"># print(state[100:104]) # check pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Since it can be simplified, there are only two situations of old_state[104]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># old_state[104] is even</span></span><br><span class="line">y = (state[<span class="number">0</span>] ^ state[<span class="number">103</span>]) &lt;&lt; <span class="number">1</span>  <span class="comment"># recover y</span></span><br><span class="line"><span class="comment"># print(y) # check pass</span></span><br><span class="line">poss_1 = y &amp; <span class="number">0x7fffffff</span></span><br><span class="line">poss_2 = (y &amp; <span class="number">0x7fffffff</span>) | <span class="number">0x80000000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(poss_1)</span></span><br><span class="line"><span class="comment"># print(poss_2)</span></span><br><span class="line"><span class="comment"># check pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># get the seed of each situation</span></span><br><span class="line">poss_1 = inv_srand(poss_1, <span class="number">104</span>)</span><br><span class="line">poss_2 = inv_srand(poss_2, <span class="number">104</span>)</span><br><span class="line">print(poss_1)</span><br><span class="line">print(poss_2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate md5 dictionary</span></span><br><span class="line">md5_dic = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string.printable:</span><br><span class="line">    md5_dic.append(hashlib.md5(i.encode()).digest())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">random_1 = mt73991(poss_1)</span><br><span class="line">random_2 = mt73991(poss_2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recover the flag from random_1</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">    key = <span class="string">b''</span>.join([random_1.getramdanbits() <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">4</span>)])</span><br><span class="line">    decrypt(key, cipher[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Since random_1 is the correct one, random_2 can be ignored.</span></span><br></pre></td></tr></table></figure><p>ËøôÈ¢ò‰∏ÄÂºÄÂßãÂá∫È¢ò‰∫∫ÊêûÈîô‰∫Ü„ÄÇ„ÄÇ„ÄÇËá™Èó≠‰∫Ü‰∏Ä‰∏ãÂçà</p><h1 id="ËÆ§Ê∏ÖÂΩ¢ÂäøÂª∫Á´ã‰ø°ÂøÉ"><a class="markdownIt-Anchor" href="#ËÆ§Ê∏ÖÂΩ¢ÂäøÂª∫Á´ã‰ø°ÂøÉ"></a> ËÆ§Ê∏ÖÂΩ¢ÂäøÔºåÂª∫Á´ã‰ø°ÂøÉ</h1><p>After observing the <a href="http://task.py" target="_blank" rel="noopener">task.py</a>, we can find that this is a classical discrete logarithm problem. Let‚Äôs see the file.</p><p><strong><a href="http://task.py" target="_blank" rel="noopener">task.py</a></strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">25</span>)</span><br><span class="line">e = <span class="comment"># Hidden</span></span><br><span class="line">q = getPrime(<span class="number">25</span>)</span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag.strip(<span class="string">b"npuctf&#123;"</span>).strip(<span class="string">b"&#125;"</span>))</span><br><span class="line"></span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(c)</span><br><span class="line">print(pow(<span class="number">2</span>, e, n))</span><br><span class="line">print(pow(<span class="number">4</span>, e, n))</span><br><span class="line">print(pow(<span class="number">8</span>, e, n))</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">169169912654178</span></span><br><span class="line"><span class="string">128509160179202</span></span><br><span class="line"><span class="string">518818742414340</span></span><br><span class="line"><span class="string">358553002064450</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><h2 id="explanation-2"><a class="markdownIt-Anchor" href="#explanation-2"></a> Explanation</h2><p>There are many methods to solve discrete logarithm problems, BSGS(Baby Steps Giant Steps), SPH method and so on.</p><h2 id="condition-2"><a class="markdownIt-Anchor" href="#condition-2"></a> Condition</h2><p>There are four equations in <a href="http://task.py" target="_blank" rel="noopener">task.py</a> and the remains of four equations are given. The flag is in the first equations. Here is what we have known.</p><blockquote><p>The length of q and p</p><p>remains of four equations</p></blockquote><p>My idea is that n is possible to be solved and after that we can use the second equation to calculate e, using  discrete logarithm calculation methods.</p><h2 id="details-2"><a class="markdownIt-Anchor" href="#details-2"></a> Details</h2><p>We can notice that:</p><p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mtext>‚ÄÖ‚Ää</mtext><mi mathvariant="normal">‚à£</mi><mtext>‚ÄÖ‚Ää</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>c</mi><msup><mn>1</mn><mn>3</mn></msup><mtext>‚ÄÖ‚Ää</mtext><mo>‚àí</mo><mtext>‚ÄÖ‚Ää</mtext><mi>c</mi><mn>3</mn><mo separator="true">,</mo><mtext>‚ÄÖ‚Ää</mtext><mi>c</mi><msup><mn>1</mn><mn>2</mn></msup><mtext>‚ÄÖ‚Ää</mtext><mo>‚àí</mo><mtext>‚ÄÖ‚Ää</mtext><mi>c</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n\;|\;gcd(c1^{3}\;-\;c3,\;c1^{2}\;-\;c2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">‚à£</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">c</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">c</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">c</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></p><p>From this character and another character that n is the product of two big prime number, we can get n.</p><p>After that, it is really convenient that we can use discrete_log() function in Sage to calculate e. Luckily, e is coprime with n, so the inverse exists. The decryption is the similar with rsa.</p><h2 id="realization-2"><a class="markdownIt-Anchor" href="#realization-2"></a> Realization</h2><p>My realization.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">ture<span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">tureture<span class="keyword">return</span> a, <span class="number">0</span></span><br><span class="line">turea, b = gcd(b, a % b)</span><br><span class="line">ture<span class="keyword">return</span> a, b</span><br><span class="line"></span><br><span class="line">c = <span class="number">169169912654178</span></span><br><span class="line">c_1 = <span class="number">128509160179202</span></span><br><span class="line">c_2 = <span class="number">518818742414340</span></span><br><span class="line">c_3 = <span class="number">358553002064450</span></span><br><span class="line"></span><br><span class="line">dc_1 = c_1 ** <span class="number">2</span> - c_2</span><br><span class="line">dc_2 = c_1 ** <span class="number">3</span> - c_3</span><br><span class="line">n = gcd(dc_1, dc_2)[<span class="number">0</span>] / <span class="number">2</span></span><br><span class="line"><span class="comment"># print(n) # check pass</span></span><br><span class="line"></span><br><span class="line">n.factor()</span><br><span class="line">p = <span class="number">18195301</span></span><br><span class="line">q = <span class="number">28977097</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">e = discrete_log(Mod(c_1, n), Mod(<span class="number">2</span>, n))</span><br><span class="line"><span class="comment"># print(e)  # check pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(gcd(e, phi)[0])  # check pass</span></span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h2 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h2><p><a href="https://en.wikipedia.org/wiki/Mersenne_Twister" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Mersenne_Twister</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Only review in Crypto.&lt;/p&gt;
&lt;h1 id=&quot;what-does-the-tag-mean&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#what-does-the-tag-mean&quot;&gt;&lt;/a&gt; What does the
      
    
    </summary>
    
    
    
      <category term="Review" scheme="https://buki-freak.github.io/tags/Review/"/>
    
  </entry>
  
  <entry>
    <title>2020-05-03</title>
    <link href="https://buki-freak.github.io/2020/05/03/2020-05-03/"/>
    <id>https://buki-freak.github.io/2020/05/03/2020-05-03/</id>
    <published>2020-05-03T14:44:24.000Z</published>
    <updated>2020-05-03T14:50:02.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="what-i-have-done"><a class="markdownIt-Anchor" href="#what-i-have-done"></a> What I Have Done</h1><p>Sadly, the quiz yesterday is still unsolved. It seems that z3-solver doesn‚Äôt work. As a result, I study <em><strong>Correlation Attack</strong></em>  which is a kind of brute-force attack method. The method seems to work now and I am trying to understanding the codes written by others. Daily IELTS exercises have been done. What a day!</p><h1 id="things-to-learn-and-improve"><a class="markdownIt-Anchor" href="#things-to-learn-and-improve"></a> Things to Learn and Improve</h1><ul><li>Stream Cipher - Correlation Attack Method</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;what-i-have-done&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#what-i-have-done&quot;&gt;&lt;/a&gt; What I Have Done&lt;/h1&gt;
&lt;p&gt;Sadly, the quiz yesterday is s
      
    
    </summary>
    
    
    
      <category term="Daily Post" scheme="https://buki-freak.github.io/tags/Daily-Post/"/>
    
  </entry>
  
  <entry>
    <title>2020-05-02</title>
    <link href="https://buki-freak.github.io/2020/05/02/2020-05-02/"/>
    <id>https://buki-freak.github.io/2020/05/02/2020-05-02/</id>
    <published>2020-05-02T13:12:07.000Z</published>
    <updated>2020-05-02T13:22:44.870Z</updated>
    
    <content type="html"><![CDATA[<h1 id="what-i-have-done"><a class="markdownIt-Anchor" href="#what-i-have-done"></a> What I Have Done</h1><p>A competition is held in these days, exciting and also exhausting! I am confident on a quiz about LFSR, which I have lately learned. However, things always does go in the right way, isn‚Äôt it? After being trapped for over five hours, I went to sleep‚Ä¶ While I did several IELTS reading exercises, oh of course, I have finished <em>The End of the fxxking world Season One</em> just for fun ha ha ha!</p><h1 id="things-to-learn-and-improve"><a class="markdownIt-Anchor" href="#things-to-learn-and-improve"></a> Things to Learn and Improve</h1><ul><li>z3-solver</li><li>English reading speed</li><li>Be easygoing</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;what-i-have-done&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#what-i-have-done&quot;&gt;&lt;/a&gt; What I Have Done&lt;/h1&gt;
&lt;p&gt;A competition is held in these
      
    
    </summary>
    
    
    
      <category term="Daily Post" scheme="https://buki-freak.github.io/tags/Daily-Post/"/>
    
  </entry>
  
  <entry>
    <title>Greeting</title>
    <link href="https://buki-freak.github.io/2020/05/01/Greeting/"/>
    <id>https://buki-freak.github.io/2020/05/01/Greeting/</id>
    <published>2020-05-01T12:33:15.000Z</published>
    <updated>2020-05-01T12:57:56.341Z</updated>
    
    <content type="html"><![CDATA[<p>Today, I have deleted all blogs deployed before. My greeting is below.</p><h1 id="the-past"><a class="markdownIt-Anchor" href="#the-past"></a> The Past</h1><p>‚ÄãFor a so-called loser, it is always mournful to talk about his or her past. Actually, I am one of them, after failing the college entrance examination. What‚Äôs more, things go wrong in these university days. It seems that I have have been trapped for such a long time, or have had a nightmare. Families, friends, mates, the environment, ‚Ä¶, everything goes in a wrong way. However, Mama usually tells  me to be positive, which merely works at some time I think. Well, as is told, if you don‚Äôt like this world, you can just try to leave it and choose your life. It will be alright, since seldom people can live for 100 years. I mean I should do what I really want to do in limited time. Therefore, stop to complain about the past, leave that fxxking world and alter a world that you want.</p><h1 id="present-days"><a class="markdownIt-Anchor" href="#present-days"></a> Present Days</h1><p>‚ÄãWell, all roads lead to Rome. There are many ways to achieve your ambition and I choose that one that I have lately planned. Once the goal is settled, you only need to:</p><ul><li>Focus</li><li>Focus</li><li>Focus</li></ul><h1 id="future"><a class="markdownIt-Anchor" href="#future"></a> Future</h1><p>Future is unpredictable, but we should be hopeful. Look at the sky, and you will find how lovely it is to see the past of others. They are shining for you.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Today, I have deleted all blogs deployed before. My greeting is below.&lt;/p&gt;
&lt;h1 id=&quot;the-past&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#the-past
      
    
    </summary>
    
    
    
      <category term="Personal Development" scheme="https://buki-freak.github.io/tags/Personal-Development/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://buki-freak.github.io/2020/05/01/hello-world/"/>
    <id>https://buki-freak.github.io/2020/05/01/hello-world/</id>
    <published>2020-05-01T12:30:10.251Z</published>
    <updated>2019-08-27T01:03:22.557Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="quick-start"><a class="markdownIt-Anchor" href="#quick-start"></a> Quick Start</h2><h3 id="create-a-new-post"><a class="markdownIt-Anchor" href="#create-a-new-post"></a> Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="run-server"><a class="markdownIt-Anchor" href="#run-server"></a> Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="generate-static-files"><a class="markdownIt-Anchor" href="#generate-static-files"></a> Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="deploy-to-remote-sites"><a class="markdownIt-Anchor" href="#deploy-to-remote-sites"></a> Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
